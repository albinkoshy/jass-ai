# Reinforcement Learning for the Swiss Card Game Schieber Jass

This repository contains the code for my semester project at the Swiss Data Science Center, focusing on applying RL to the Swiss card game Schieber Jass.

## Introduction

This project demonstrates how RL techniques, including Deep Q-Networks (DQN) and Double DQN (DDQN), can be applied to Schieber Jass. It includes:

- A custom environment for Schieber Jass built from scratch.
- RL agents trained to make strategic decisions.
- Baseline agents (random and greedy players) for comparison.
- A human agent allowing a human to participate in the game.
- Comprehensive evaluation of agent performance using metrics such as win rates and reward progression.

## Project Structure

- src: Contains all the source code for this project
    - agents: Agent implementations
    - envs: Environment implemenation
    - train.py: Train the agents in the environment
    - evaluate.py: Test the strengths of the agents
- scripts: Contains the shell scripts used to train the agents
- csv_logs: The resuls of the experiments in csv format
- figures: The figures generated by experiment_results.ipynb
- models: The trained models used in experiments_results.ipynb and game_type_decisions.ipynb

## Installation

To install the required dependencies, create a new conda environment and run the following command:
```
conda create --name <env_name> --file requirements.txt
```
Alternatively, you can install the dependencies using pip:
```
pip install -r requirements.txt
```
Make sure to activate your environment before running the code.

## Usage

To train agents, do the following with the appropriate flags (more information in train.py), e.g.:
```
python src/train.py --agent=dqn --n_episodes=10000 --hidden_sizes=128,128
```

To evaluate the trained agents, indicate the model_path and specify the layer sizes (more information in evaluate.py), e.g.:
```
python src/evaluate.py --model_path=dqn_agent_128-128_500000.pt --n_episodes=10000 --hidden_size=128,128
```

## Results
Please refer to the experiment_results.ipynb and game_type_decisions.ipynb notebooks.

## References

- [Schieber Jass rules](https://www.swisslos.ch/en/jass/informations/jass-rules/schieber-jass.html)
- RL algorithms: [DQN](https://www.nature.com/articles/nature14236), [Double DQN](https://arxiv.org/pdf/1509.06461)